#!/bin/bash
updates="$(fwupdmgr refresh > /dev/null 2>&1 && fwupdmgr get-updates 2> /dev/null)"
icon="ï‹›"
tooltip="Firmware updates:\n fwupdmgr get-updates && fwupdmgr update"
tooltip="$(printf "$tooltip" | perl -pe 's/\n/\\n/g' | perl -pe 's/(?:\\n)+$//')"

if [ -z "$updates" ]; then
    printf '{"text": ""}\n'
else
    printf '{"text": "%s", "tooltip": "%s" }\n' "$icon" "$tooltip"
fi
