#!/bin/bash

count=$(notmuch count tag:family and not tag:archive and tag:unread)
if [[ $count -gt 0 ]]; then
  notify-send -i /usr/share/doc/neomutt/logo/neomutt-128.png -u critical -t 10000 "Email" "$(notmuch search --limit=1 tag:family and not tag:archive and tag:unread | awk '{print $1}' | xargs notmuch show --format=json --entire-thread=false | jq -r '..| select(."content-type"? == "text/plain") | .content' | head -20)"
fi
