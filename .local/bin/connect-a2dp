#!/bin/bash
set -ef -o pipefail

usage() {
    echo "$(basename $0) bluetooth_mac 00:11:22:33:44:55 [name]"
    exit 1
}

connect() {
    bluetooth on
    sleep 0.5
    echo 'default-agent' | bluetoothctl
    sleep 1
    echo "connect $1" | bluetoothctl
    sleep 1
}

if [ -z "$1" ]; then
    usage
else
    mac="${1::17}"
    name="${2:-$1}"
    echo "Connecting to $name ..."
    connect "$mac"
    notify-send -i /usr/share/icons/ePapirus-Dark/symbolic/status/bluetooth-active-symbolic.svg "Bluetooth" "Connected to ${name}"
fi
