#!/bin/sh

error() {
	echo >&2 "$*"
	exit 1
}

[ $# -gt 0 ] || error "Usage: $0 <action> (e.g. $0 output-mute)"

case "$1" in
	bt-toggle-profile)
		bt_card=$(pactl list | grep "Name: bluez_card." | cut -d ' ' -f 2)
		a2dp=$(pactl list | grep Active | grep a2dp-sink-sbc)
		[ -n "$bt_card" ] || error "No bluetooth device connected"
		[ -n "$a2dp" ] && new=headset-head-unit-msbc || new=a2dp-sink-sbc
		pactl set-card-profile "$bt_card" "$new"
		;;
	bt-connect-headphones) bluetoothctl connect 14:3F:A6:29:35:64 ;;
	bt-connect-headset) bluetoothctl connect C0:86:B3:60:91:88 ;;
	bt-connect-speakers) bluetoothctl connect 08:DF:1F:A9:9E:EC ;;
	bt-connect-earplugs) bluetoothctl connect 00:0E:DD:06:24:1C ;;
	bt-disconnect) bluetoothctl disconnect ;;
	output-mute) pactl set-sink-mute @DEFAULT_SINK@ toggle ;;
	input-mute) pactl set-source-mute @DEFAULT_SOURCE@ toggle ;;
	output-volume-up) pactl set-sink-volume @DEFAULT_SINK@ +5% ;;
	output-volume-down) pactl set-sink-volume @DEFAULT_SINK@ -5% ;;
	input-volume-up) pactl set-source-volume @DEFAULT_SOURCE@ +5% ;;
	input-volume-down) pactl set-source-volume @DEFAULT_SOURCE@ -5% ;;
	*) error "Unknown action '$1'" ;;
esac
