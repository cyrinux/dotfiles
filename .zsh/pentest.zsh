
# Stego
alias stego-tools='docker run -it --rm -v $HOME/library/pentest:/data dominicbreuker/stego-toolkit /bin/bash'

# Jok3r
alias jok3r-kali-shell="docker start jok3r-kali-container; docker exec -it jok3r-kali-container bash"
alias jok3r-kali-start="docker run -i -t --name jok3r-kali-container -w /root/jok3r -e DISPLAY=$DISPLAY -v /tmp/.X11-unix:/tmp/.X11-unix --shm-size 2g --net=host koutto/jok3r 2>/dev/null || docker start jok3r-kali-container && jok3r-kali-shell"
alias jok3r-kali-stop="docker stop jok3r-kali-container"

# POCSAG
alias avion="sudo systemctl start dump1090.service & chromium http://localhost/index.html &"
alias skyrock='rtl_fm -f 96.0M -M wbfm -p 10  |  play -r 32k -t raw -e s -b 16 -c 1 -V1 - # skyrock'
alias pocsag='rtl_fm -p 10 -s 22050 -f 466.133M  -M fm  - | multimon-ng -t raw -a POCSAG512 -a POCSAG1200 -a POCSAG2400 -f alpha /dev/stdin'

# VunLab
alias juicyshop="docker run --rm -p 3000:3000 bkimminich/juice-shop"


# Docker OS Shells
function dockershell() {
    docker run --rm -i -t --entrypoint=/bin/bash "$@"
}

function dockershellsh() {
    docker run --rm -i -t --entrypoint=/bin/sh "$@"
}

function dockershellhere() {
    dirname=${PWD##*/}
    docker run --rm -it --entrypoint=/bin/bash -v `pwd`:/${dirname} -w /${dirname} "$@"
}

function dockershellshhere() {
    docker run --rm -it --entrypoint=/bin/sh -v `pwd`:/${dirname} -w /${dirname} "$@"
}

function dockerwindowshellhere() {
    dirname=${PWD##*/}
    docker -c 2019-box run --rm -it -v "C:${PWD}:C:/source" -w "C:/source" "$@"
}

# MISC
alias dirsearch="dirsearch -u $1 -e $2 -t 200 -H 'X-FORWARDED-FOR: 127.0.0.1'"

impacket() {
    docker run --rm -it rflathers/impacket "$@"
}

smbservehere() {
    local sharename
    [[ -z $1 ]] && sharename="SHARE" || sharename=$1
    sudo ufw allow CIFS
    docker run --rm -it -p 445:445 -v "${PWD}:/tmp/serve" rflathers/impacket smbserver.py -smb2support $sharename /tmp/serve
    sudo ufw deny CIFS
}

nginxhere() {
    docker run --rm -it -p 80:80 -p 443:443 -v "${PWD}:/srv/data" rflathers/nginxserve
}

webdavhere() {
    docker run --rm -it -p 80:80 -v "${PWD}:/srv/data/share" rflathers/webdav
}

metasploit() {
    docker run --rm -it -v "${HOME}/.msf4:/home/msf/.msf4" metasploitframework/metasploit-framework ./msfconsole "$@"
}

metasploitports() {
    docker run --rm -it -v "${HOME}/.msf4:/home/msf/.msf4" -p 8443-8500:8443-8500 metasploitframework/metasploit-framework ./msfconsole "$@"
}

msfvenomhere() {
    docker run --rm -it -v "${HOME}/.msf4:/home/msf/.msf4" -v "${PWD}:/data" metasploitframework/metasploit-framework ./msfvenom "$@"
}

reqdump() {
    docker run --rm -it -p 80:3000 rflathers/reqdump
}

postfiledumphere() {
    docker run --rm -it -p80:3000 -v "${PWD}:/data" rflathers/postfiledump
}

nmap-onion() {
  docker run --rm -it milesrichardson/onion-nmap $@
}

crackme() {
  ctf_name=$1
  docker run -d \
    --rm \
    -h "${ctf_name}" \
    --name "${ctf_name}" \
    -v "${HOME}/library/ctf/${ctf_name}:/ctf/work" \
    -p 23946:23946 \
    --cap-add=SYS_PTRACE \
    skysider/pwndocker

  docker exec -it "${ctf_name}" /bin/bash
}

amassdocker() {
  sudo -A docker run --rm -v /home/cyril/library/pentest/results:/amass/ caffix/amass:latest $@
}

whatwebdocker() {
 docker run -it --rm ilyaglow/whatweb -v "$@"
}

reconsudomy() {
      docker run -v /home/cyril/library/pentest/results:/usr/lib/sudomy/output -v /home/cyril/library/pentest/recon/.sudomy.api:/usr/lib/sudomy/sudomy.api -it --rm screetsec/sudomy:v1.1.8 "$@"
}

reconsubdomain() { curl -sL https://git.io/JesKK | bash -s $1
    cat $1.txt|httprobe|cut -d "/" -f3|sort -u |tee $1.txt
    echo "██████████████████████████████████████████████████████████████████████████████████████████████████████"
    echo "Detect Alive Subdomain $(wc -l $1.txt|awk '{ print $1 }' )" "=> ${1}"
    echo "File Location : "$(pwd)/"$1.txt"
}

reconlazy() {
    docker pull soaringswine/lazyrecon_docker
    docker run -it  --rm --user $(id -u):$(id -g) -v /home/cyril/library/pentest/results:/home/lazyrecon_user/tools/lazyrecon/lazyrecon_results/ soaringswine/lazyrecon_docker -d "$@"
}

reconfindomain() {
    findomain -t "$@" | gwdomains
}

reconit() {
   docker run -it --rm --user $(id -u):$(id -g) -v /home/cyril/library/pentest/results:/home/reconit_user/tools/reconit/reconit_results/  reconit  "$@"
}

recon() {
   docker run -it --rm --user $(id -u):$(id -g) -v /home/cyril/library/pentest/results/:/home/reconit_user/tools/reconit/reconit_results/ reconit "$@"
}

recon-intrigue() {
    docker run -e LANG=C.UTF-8 -v ~/intrigue-core-data:/data -p 0.0.0.0:7777:7777 --memory=8g -it intrigue-core
}

assetfinder() { eval $(pass show api/assetfinder); /usr/bin/assetfinder $@}

rotatingproxy(){
 docker rm -f rotatingproxy 2>&1 >/dev/null || echo "Nothing to stop"
 echo "Starting a rotation proxy with ${1:-25} tor instances"
 docker run -d --name rotatingproxy --rm -p 5566:5566 -p 4444:4444 --env tors=${1:-25} mattes/rotating-proxy
 echo "To test: curl -x 127.0.0.1:5566 https://ip.levis.ws/ip"
 sleep 5
 curl -x 127.0.0.1:5566 https://ip.levis.ws/ip
 curl -x 127.0.0.1:5566 https://ip.levis.ws/ip
 curl -x 127.0.0.1:5566 https://ip.levis.ws/ip
 curl -x 127.0.0.1:5566 https://ip.levis.ws/ip
}

osmedeus() {
    docker volume create osmedeus_workspaces
    docker run -it --rm --net=container:gluetun --name osmedeus -v osmedeus_workspaces:/root/.osmedeus/workspaces -p 8000:8000 mablanco/osmedeus:2.2-20200227 ./osmedeus.py "$@"
}

jaeles() {
    docker run --net=container:gluetun -t --rm mablanco/jaeles "$@"
}

loki() {
   docker volume create loki_signatures
   docker run --net=container:gluetun -it --rm -v "loki_signatures:/app/signature-base" -v "$1:/app/scan"  mablanco/loki -p /app/scan
}

rapidscan() {
    docker run --net=container:gluetun -t --rm mablanco/rapidscan:latest "$@"
}

# Email gathering
infoga() {
    docker run --net=container:gluetun --rm -v "$(pwd):/tmp/" -it xshuden/infoga:latest "$@"
}

alias metabigor="docker run --net=container:gluetun --rm mablanco/metabigor"

# Find username on the web
investigo() {
    docker run --rm -ti x0rzkov/investigo:latest investigo "$@"
}

sherlock() {
    docker run --rm -ti theyahya/sherlock:latest --print-found  "$@"
}

# Misc
website_aspirator() {
    wget --no-check-certificate -r -np -R "index.html*" "$@"
}

asnrecon() {
    docker run --net=container:gluetun --rm -ti asnrecon
}

# Vuln scan
openvas() {
    docker volume create openvas
    docker run -d -p 127.0.0.1:9392:9392 -e USERNAME="admin" -e PASSWORD="admin" --volume openvas:/opt/gvm --name openvas --restart unless-stopped jeffleder/gvm-docker
}


blackeye() {
    docker run -d --name blackeye vishnunair/docker-blackeye:latest
}
